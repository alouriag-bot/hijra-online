<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Souk Marocain AI Assistant</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
  button { cursor: pointer; }
  .city-btn { background: #1e40af; color: white; padding: 8px 16px; margin: 4px; border-radius: 5px; border: none; }
  .category-btn { display: block; width: 100%; text-align: left; padding: 8px; border-bottom: 1px solid #ccc; background: #e5e7eb; margin-bottom: 2px; border-radius: 3px; }
  .category-btn:hover { background: #d1d5db; }
  #answerBox { background: #fff; padding: 15px; border-radius: 5px; box-shadow: 0 0 5px rgba(0,0,0,0.1); margin-top: 10px; }
  h2, h3 { margin-bottom: 10px; }
</style>
</head>
<body>

<h2>اختر المدينة / Choisissez la ville :</h2>
<div id="cityButtons"></div>

<div id="categoryList"></div>

<div id="answerBox"></div>

<script>
// المدن والفئات
const cities = [
  {
    name: "Meknès",
    categories: ["Mosquées","Hammams","Sports","Hôtels","Sites touristiques","Souks populaires","Marchés"]
  },
  {
    name: "Marrakech",
    categories: ["Mosquées","Hammams","Sports","Hôtels","Sites touristiques","Souks populaires","Marchés"]
  },
  {
    name: "Fès",
    categories: ["Mosquées","Hammams","Sports","Hôtels","Sites touristiques","Souks populaires","Marchés"]
  }
];

// إنشاء أزرار المدن
const cityButtonsDiv = document.getElementById('cityButtons');
cities.forEach(city => {
  const btn = document.createElement('button');
  btn.textContent = city.name;
  btn.className = "city-btn";
  btn.onclick = () => showCategories(city.name);
  cityButtonsDiv.appendChild(btn);
});

function showCategories(cityName) {
  const city = cities.find(c => c.name === cityName);
  const categoryListDiv = document.getElementById('categoryList');
  const answerBox = document.getElementById('answerBox');
  answerBox.innerHTML = "";

  categoryListDiv.innerHTML = city.categories.map(cat =>
    `<button onclick="askAI('${cityName}','${cat}')" class="category-btn">${cat}</button>`
  ).join("");
}

// استدعاء الذكاء الاصطناعي
async function askAI(city, category) {
  const answerBox = document.getElementById('answerBox');
  answerBox.innerHTML = "جاري التحميل... / Chargement...";

  // استبدل YOUR_OPENAI_API_KEY بمفتاح OpenAI الخاص بك
  const response = await fetch("https://api.openai.com/v1/chat/completions", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer YOUR_OPENAI_API_KEY"
    },
    body: JSON.stringify({
      model: "gpt-4",
      messages: [
        {
          role: "system",
          content: "Tu es un assistant qui fournit des listes détaillées des lieux au Maroc selon la catégorie, avec nom, description et lien Google Maps. Réponds aussi en arabe si nécessaire."
        },
        {
          role: "user",
          content: `Fournis-moi une liste de 5 ${category} à ${city}, avec nom, courte description et lien Google Maps.`
        }
      ],
      max_tokens: 600
    })
  });

  const data = await response.json();
  answerBox.innerHTML = data.choices[0].message.content.replace(/\n/g,"<br>");
}
</script>

</body>
</html>
